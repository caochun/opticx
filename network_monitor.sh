#!/bin/bash

echo "=========================================="
echo "Vagranté›†ç¾¤ç½‘ç»œæµé‡ç›‘æ§å·¥å…·"
echo "=========================================="
echo "æ—¶é—´: $(date)"
echo ""

echo "ğŸ“Š é›†ç¾¤ç½‘ç»œæ‹“æ‰‘:"
echo "----------------------------------------"
echo "ğŸ–¥ï¸  æ§åˆ¶å™¨èŠ‚ç‚¹ (slurmctld): 192.168.56.10"
echo "ğŸ–¥ï¸  è®¡ç®—èŠ‚ç‚¹1 (compute1): 192.168.56.11"
echo "ğŸ–¥ï¸  è®¡ç®—èŠ‚ç‚¹2 (compute2): 192.168.56.12"
echo "ğŸ–¥ï¸  ç™»å½•èŠ‚ç‚¹ (login): 192.168.56.13"
echo ""

echo "ğŸ”§ ç½‘ç»œç›‘æ§å‘½ä»¤:"
echo "----------------------------------------"
echo "1. æŸ¥çœ‹é›†ç¾¤ç½‘ç»œçŠ¶æ€:"
echo "   vagrant ssh slurmctld -c '/tmp/network_summary.sh'"
echo ""
echo "2. å®æ—¶ç½‘ç»œæµé‡ç›‘æ§:"
echo "   vagrant ssh slurmctld -c 'sudo iftop -i eth2'"
echo ""
echo "3. ç½‘ç»œå¸¦å®½ä½¿ç”¨ç›‘æ§:"
echo "   vagrant ssh slurmctld -c 'sudo nload eth2'"
echo ""
echo "4. è¿›ç¨‹ç½‘ç»œä½¿ç”¨ç›‘æ§:"
echo "   vagrant ssh slurmctld -c 'sudo nethogs'"
echo ""
echo "5. ç½‘ç»œè¿æ¥ç›‘æ§:"
echo "   vagrant ssh slurmctld -c 'watch -n 1 \"ss -tuln | grep LISTEN\"'"
echo ""
echo "6. ç½‘ç»œå»¶è¿Ÿç›‘æ§:"
echo "   vagrant ssh slurmctld -c 'ping -c 10 192.168.56.11'"
echo ""

echo "ğŸ“ˆ ç½‘ç»œæµé‡åˆ†æ:"
echo "----------------------------------------"
echo "â€¢ eth0: ä¸»è¦ç½‘ç»œæ¥å£ (788MBæ¥æ”¶/5MBå‘é€)"
echo "â€¢ eth1: è™šæ‹Ÿç½‘ç»œæ¥å£ (81MBæ¥æ”¶/0.3MBå‘é€)"
echo "â€¢ eth2: é›†ç¾¤å†…éƒ¨ç½‘ç»œ (0.7MBæ¥æ”¶/0.6MBå‘é€)"
echo ""

echo "ğŸŒ é›†ç¾¤ç½‘ç»œå»¶è¿Ÿ:"
echo "----------------------------------------"
echo "â€¢ æ‰€æœ‰èŠ‚ç‚¹é—´å»¶è¿Ÿ < 1ms"
echo "â€¢ ç½‘ç»œè¿æ¥ç¨³å®šï¼Œæ— ä¸¢åŒ…"
echo "â€¢ é€‚åˆé«˜æ€§èƒ½è®¡ç®—ä»»åŠ¡"
echo ""

echo "âš¡ ç½‘ç»œæ€§èƒ½ä¼˜åŒ–å»ºè®®:"
echo "----------------------------------------"
echo "1. ä½¿ç”¨eth2æ¥å£è¿›è¡Œé›†ç¾¤å†…éƒ¨é€šä¿¡"
echo "2. ç›‘æ§NFSæµé‡ (ç«¯å£2049)"
echo "3. ç›‘æ§SLURMé€šä¿¡ (ç«¯å£6817)"
echo "4. å®šæœŸæ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ"
echo ""

echo "ğŸ” å®æ—¶ç›‘æ§è„šæœ¬:"
echo "----------------------------------------"
echo "è¿è¡Œä»¥ä¸‹å‘½ä»¤å¼€å§‹å®æ—¶ç›‘æ§:"
echo "vagrant ssh slurmctld -c '/tmp/realtime_network_monitor.sh'"
echo ""

echo "=========================================="
echo "ç½‘ç»œç›‘æ§å·¥å…·å®Œæˆ"
echo "=========================================="

